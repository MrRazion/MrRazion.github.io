<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rule34 Telegram WebApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* Modern, clean design with Telegram-like aesthetics */
        :root {
            --primary-color: #0088cc;
            --secondary-color: #2c3e50;
            --background-dark: #1a1a1d;
            --background-light: #242427;
            --card-bg: #2d2d30;
            --text-color: #f5f5f5;
            --text-secondary: #b0b0b0;
            --accent-red: #e74c3c;
            --accent-blue: #3498db;
            --success: #2ecc71;
            --warning: #f39c12;
            --border-radius: 12px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background-color: var(--background-dark);
            color: var(--text-color);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Loading Screen Styles */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a1d 0%, #242427 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }

        .loading-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(45deg, var(--primary-color), #00aaff);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(0, 136, 204, 0.4);
        }

        .loading-logo::before {
            content: "";
            width: 60px;
            height: 60px;
            background: var(--background-dark);
            border-radius: 50%;
        }

        .loading-logo::after {
            content: "R34";
            position: absolute;
            font-weight: bold;
            color: white;
            font-size: 24px;
        }

        .loading-text {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            background: linear-gradient(to right, var(--primary-color), #00aaff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .progress-container {
            width: 80%;
            max-width: 300px;
            height: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--primary-color), #00aaff);
            border-radius: 4px;
            transition: width 0.4s ease;
        }

        .refresh-text {
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 14px;
            letter-spacing: 1px;
        }

        /* Main Content Styles */
        #main-content {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        /* Header Styles */
        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background-color: var(--background-light);
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-text {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary-color), #00aaff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(45deg, var(--primary-color), #00aaff);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .header-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background-color: rgba(255, 255, 255, 0.08);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .header-icon:hover {
            background-color: rgba(0, 136, 204, 0.2);
            transform: translateY(-2px);
        }

        .profile-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            background-color: rgba(255, 255, 255, 0.08);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: var(--primary-color);
            border: 2px solid transparent;
            transition: var(--transition);
        }

        .profile-icon.guest {
            background-color: var(--secondary-color);
            color: white;
        }

        .profile-icon.active {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--background-dark), 0 0 0 4px var(--primary-color);
        }

        /* Content Grid Styles */
        .content-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
            margin-bottom: 30px;
        }

        .grid-item {
            border-radius: var(--border-radius);
            overflow: hidden;
            background-color: var(--card-bg);
            box-shadow: var(--box-shadow);
            position: relative;
            transition: var(--transition);
            cursor: pointer;
        }

        .grid-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .grid-item img, .grid-item video {
            width: 100%;
            height: auto;
            display: block;
        }

        .video-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: linear-gradient(45deg, #000, #333);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        /* Modal Styles */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            max-width: 90%;
            max-height: 80vh;
            position: relative;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            animation: modalEnter 0.4s ease;
        }

        @keyframes modalEnter {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-image {
            max-width: 100%;
            max-height: 70vh;
            display: block;
        }

        .modal-video {
            max-width: 100%;
            max-height: 70vh;
            border-radius: var(--border-radius);
        }

        .modal-footer {
            background-color: var(--card-bg);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }

        .action-button {
            padding: 10px 20px;
            border-radius: 30px;
            border: none;
            background: linear-gradient(45deg, #34495e, #2c3e50);
            color: var(--text-color);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .action-button:hover {
            background: linear-gradient(45deg, #2c3e50, #1a252f);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .download-btn {
            background: linear-gradient(45deg, #27ae60, #219653);
        }

        .album-btn {
            background: linear-gradient(45deg, var(--primary-color), #0081b3);
        }

        /* Comments Section */
        .comments-section {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-top: 20px;
            box-shadow: var(--box-shadow);
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: "";
            width: 4px;
            height: 20px;
            background: linear-gradient(to bottom, var(--primary-color), #00aaff);
            border-radius: 2px;
        }

        .comment-form {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .comment-input {
            flex: 1;
            padding: 12px 15px;
            border-radius: 30px;
            border: none;
            background-color: rgba(255, 255, 255, 0.08);
            color: var(--text-color);
            font-size: 14px;
        }

        .comment-input::placeholder {
            color: var(--text-secondary);
        }

        .comment-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.12);
        }

        .send-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--primary-color), #0081b3);
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(0, 136, 204, 0.4);
        }

        .comment-list {
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }

        .comment-list::-webkit-scrollbar {
            width: 6px;
        }

        .comment-list::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 3px;
        }

        .comment-list::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 3px;
        }

        .comment {
            display: flex;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .comment-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: white;
            flex-shrink: 0;
        }

        .comment-content {
            flex: 1;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .comment-author {
            font-weight: 600;
            color: var(--primary-color);
        }

        .comment-time {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .comment-text {
            line-height: 1.5;
        }

        /* Pagination Styles */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .page-btn {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background-color: var(--card-bg);
            border: none;
            color: var(--text-color);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .page-btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .page-btn.active {
            background: linear-gradient(45deg, var(--primary-color), #0081b3);
            box-shadow: 0 0 15px rgba(0, 136, 204, 0.4);
        }

        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            transform: none;
            background-color: rgba(255, 255, 255, 0.08);
        }

        /* Tags Section */
        .tags-section {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: var(--box-shadow);
        }

        .tags-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .tags-title {
            font-size: 18px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tags-title::before {
            content: "";
            width: 4px;
            height: 20px;
            background: linear-gradient(to bottom, var(--warning), #e67e22);
            border-radius: 2px;
        }

        .tag-categories {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .tag-category {
            flex: 1;
            min-width: 150px;
        }

        .category-title {
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .category-title::before {
            content: "";
            width: 3px;
            height: 15px;
            border-radius: 2px;
        }

        .copyright .category-title::before { background-color: #e74c3c; }
        .character .category-title::before { background-color: #3498db; }
        .artist .category-title::before { background-color: #2ecc71; }
        .general .category-title::before { background-color: #f39c12; }
        .meta .category-title::before { background-color: #9b59b6; }

        .tags-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag {
            padding: 5px 12px;
            border-radius: 20px;
            background-color: rgba(255, 255, 255, 0.08);
            font-size: 13px;
            transition: var(--transition);
            cursor: pointer;
        }

        .tag:hover {
            background: linear-gradient(45deg, var(--primary-color), #0081b3);
        }

        /* Disclaimer */
        .disclaimer {
            background: linear-gradient(45deg, var(--accent-red), #c0392b);
            color: white;
            border-radius: var(--border-radius);
            padding: 12px 20px;
            text-align: center;
            font-size: 14px;
            font-weight: 500;
            margin-bottom: 25px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        /* Overlay & Popup Styles */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .popup {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 400px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            transform: translateY(20px);
            opacity: 0;
            transition: all 0.4s ease;
        }

        .overlay.active .popup {
            transform: translateY(0);
            opacity: 1;
        }

        .popup-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 15px;
            text-align: center;
            background: linear-gradient(to right, var(--primary-color), #00aaff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .popup-content {
            text-align: center;
        }

        .tenor-gif-embed {
            margin: 15px 0;
            border-radius: 10px;
            overflow: hidden;
        }

        .popup-btn {
            width: 100%;
            padding: 12px;
            border-radius: 30px;
            border: none;
            background: linear-gradient(45deg, var(--primary-color), #0081b3);
            color: white;
            font-weight: 600;
            font-size: 16px;
            cursor: pointer;
            transition: var(--transition);
            margin-top: 20px;
            box-shadow: 0 4px 10px rgba(0, 136, 204, 0.3);
        }

        .popup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0, 136, 204, 0.4);
        }

        /* Settings Panel */
        .settings-panel {
            position: fixed;
            top: 0;
            right: -100%;
            width: 80%;
            max-width: 400px;
            height: 100%;
            background-color: var(--background-dark);
            z-index: 1500;
            transition: right 0.4s ease;
            box-shadow: -5px 0 15px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
            padding: 20px;
        }

        .settings-panel.active {
            right: 0;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 15px;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .panel-title {
            font-size: 20px;
            font-weight: 600;
        }

        .close-panel {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: var(--transition);
        }

        .close-panel:hover {
            background-color: rgba(255, 255, 255, 0.08);
        }

        .settings-group {
            margin-bottom: 25px;
        }

        .group-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .slider-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            color: var(--text-secondary);
            font-size: 12px;
        }

        .thumbnail-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            outline: none;
        }

        .thumbnail-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--primary-color);
            cursor: pointer;
            box-shadow: 0 0 5px rgba(0, 136, 204, 0.5);
            transition: var(--transition);
        }

        .thumbnail-slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
            background: #00aaff;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.1);
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: var(--primary-color);
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .toggle-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }

        /* Menu Panel */
        .menu-panel {
            position: fixed;
            top: 0;
            left: -100%;
            width: 80%;
            max-width: 300px;
            height: 100%;
            background-color: var(--background-dark);
            z-index: 1500;
            transition: left 0.4s ease;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
        }

        .menu-panel.active {
            left: 0;
        }

        .menu-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            cursor: pointer;
            transition: var(--transition);
        }

        .menu-item:hover {
            background-color: rgba(0, 136, 204, 0.1);
        }

        .menu-icon {
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--primary-color);
            font-size: 18px;
        }

        .menu-text {
            font-weight: 500;
        }

        .coming-soon {
            font-size: 12px;
            color: var(--warning);
            margin-top: 3px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .grid-container {
                grid-template-columns: 1fr;
            }
            
            .logo-text {
                font-size: 18px;
            }
            
            .logo-icon {
                width: 28px;
                height: 28px;
                font-size: 14px;
            }
            
            .header-icon, .profile-icon {
                width: 36px;
                height: 36px;
            }
        }

        @media (max-width: 480px) {
            .loading-text {
                font-size: 20px;
            }
            
            .modal-footer {
                flex-direction: column;
                gap: 10px;
            }
            
            .action-button {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen">
        <div class="loading-logo"></div>
        <div class="loading-text">Loading Rule34 Content</div>
        <div class="progress-container">
            <div class="progress-bar" id="loading-progress"></div>
        </div>
        <div class="refresh-text">white "refresh"</div>
    </div>

    <!-- Main Content -->
    <div id="main-content">
        <!-- Header -->
        <header class="app-header">
            <div class="logo-container">
                <div class="logo-icon">R34</div>
                <div class="logo-text">rule34</div>
            </div>
            <div class="header-actions">
                <div class="header-icon" id="settings-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M19.4 15C19.2626 15.6392 18.9959 16.2427 18.6142 16.7678L19.9086 18.0623C20.2651 18.4188 20.2651 19.0001 19.9086 19.3566C19.5521 19.7131 18.9708 19.7131 18.6142 19.3566L17.3252 18.0676C16.7958 18.446 16.1877 18.7103 15.5361 18.8397L15.1978 20.4295C15.1542 20.6327 15.003 20.8 14.8022 20.8H9.19781C8.99696 20.8 8.84579 20.6327 8.80222 20.4295L8.46388 18.8397C7.81228 18.7103 7.20418 18.446 6.67484 18.0676L5.3858 19.3566C5.02927 19.7131 4.44798 19.7131 4.09145 19.3566C3.73492 19.0001 3.73492 18.4188 4.09145 18.0623L5.3858 16.7678C5.00412 16.2427 4.73739 15.6392 4.6 15L3.0102 15.3383C2.80697 15.3819 2.63971 15.2307 2.63971 15.03C2.63971 14.8292 2.80697 14.678 3.0102 14.7216L4.6 15.06C4.73739 14.4208 5.00412 13.8173 5.3858 13.2922L4.09145 12.0032C3.73492 11.6467 3.73492 11.0654 4.09145 10.7088C4.44798 10.3523 5.02927 10.3523 5.3858 10.7088L6.67484 11.9978C7.20418 11.6194 7.81228 11.3551 8.46388 11.2257L8.80222 9.63592C8.84579 9.4327 9.00304 9.26544 9.19781 9.26544H14.8022C15.003 9.26544 15.1542 9.4327 15.1978 9.63592L15.5361 11.2257C16.1877 11.3551 16.7958 11.6194 17.3252 11.9978L18.6142 10.7088C18.9708 10.3523 19.5521 10.3523 19.9086 10.7088C20.2651 11.0654 20.2651 11.6467 19.9086 12.0032L18.6142 13.2922C18.9959 13.8173 19.2626 14.4208 19.4 15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="header-icon" id="menu-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="profile-icon" id="profile-icon">U</div>
            </div>
        </header>

        <!-- Content Area -->
        <main class="content-container">
            <!-- Content Grid -->
            <div class="grid-container" id="content-grid">
                <!-- Content will be loaded dynamically -->
            </div>

            <!-- Comments Section -->
            <div class="comments-section">
                <h2 class="section-title">Comments</h2>
                <div class="comment-form">
                    <input type="text" class="comment-input" id="comment-input" placeholder="Write a comment...">
                    <button class="send-btn" id="send-comment">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 2L11 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M22 2L15 22L11 13L2 9L22 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>
                </div>
                <div class="comment-list" id="comment-list">
                    <!-- Comments will be loaded dynamically -->
                </div>
            </div>

            <!-- Pagination -->
            <div class="pagination" id="pagination">
                <button class="page-btn" id="prev-page">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 19L8 12L15 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <!-- Page buttons will be added dynamically -->
                <button class="page-btn" id="next-page">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 5L16 12L9 19" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>

            <!-- Tags Section -->
            <div class="tags-section">
                <div class="tags-header">
                    <h2 class="tags-title">Popular Tags</h2>
                    <div class="view-all">View all</div>
                </div>
                <div class="tag-categories">
                    <div class="tag-category copyright">
                        <h3 class="category-title">Copyright</h3>
                        <div class="tags-list">
                            <span class="tag">anime</span>
                            <span class="tag">manga</span>
                            <span class="tag">game</span>
                            <span class="tag">cartoon</span>
                        </div>
                    </div>
                    <div class="tag-category character">
                        <h3 class="category-title">Character</h3>
                        <div class="tags-list">
                            <span class="tag">asuna</span>
                            <span class="tag">rem</span>
                            <span class="tag">zero two</span>
                            <span class="tag">miku</span>
                        </div>
                    </div>
                    <div class="tag-category artist">
                        <h3 class="category-title">Artist</h3>
                        <div class="tags-list">
                            <span class="tag">pixiv</span>
                            <span class="tag">deviantart</span>
                            <span class="tag">twitter</span>
                            <span class="tag">fanart</span>
                        </div>
                    </div>
                    <div class="tag-category general">
                        <h3 class="category-title">General</h3>
                        <div class="tags-list">
                            <span class="tag">solo</span>
                            <span class="tag">breasts</span>
                            <span class="tag">nipples</span>
                            <span class="tag">panties</span>
                        </div>
                    </div>
                    <div class="tag-category meta">
                        <h3 class="category-title">Meta</h3>
                        <div class="tags-list">
                            <span class="tag">highres</span>
                            <span class="tag">best quality</span>
                            <span class="tag">masterpiece</span>
                            <span class="tag">detailed</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Disclaimer -->
            <div class="disclaimer">
                This Telegram bot is not an official rule34.xxx service and was made with fanaticism.
            </div>
        </main>

        <!-- Post Modal -->
        <div class="modal" id="post-modal">
            <div class="modal-content">
                <img src="" alt="Post image" class="modal-image" id="modal-image">
                <video class="modal-video" id="modal-video" controls style="display: none;"></video>
                <div class="modal-footer">
                    <button class="action-button download-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 15V19C21 19.5304 20.7893 20.0391 20.4142 20.4142C20.0391 20.7893 19.5304 21 19 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Download
                    </button>
                    <button class="action-button album-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 11.5V17.5C21 18.0304 20.7893 18.5391 20.4142 18.9142C20.0391 19.2893 19.5304 19.5 19 19.5H5C4.46957 19.5 3.96086 19.2893 3.58579 18.9142C3.21071 18.5391 3 18.0304 3 17.5V11.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M3 7.5L10.8 7.5C11.2971 7.5 11.7 7.17157 11.7 6.75L12.3 4.25C12.3 3.82843 12.7029 3.5 13.2 3.5L21 3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Add to Album
                    </button>
                </div>
            </div>
        </div>

        <!-- Profile Popup -->
        <div class="overlay" id="profile-overlay">
            <div class="popup">
                <h2 class="popup-title">Welcome to Rule34 WebApp!</h2>
                <div class="popup-content">
                    <p>Enjoy the best Rule34 content right in your Telegram!</p>
                    <div class="tenor-gif-embed" data-postid="10997822561393768142" data-share-method="host" data-aspect-ratio="1.76596" data-width="100%">
                        <a href="https://tenor.com/view/hiiragi-utena-gif-10997822561393768142">Hiiragi Utena GIF</a> from <a href="https://tenor.com/search/hiiragi+utena-gifs">Hiiragi Utena GIFs</a>
                    </div>
                    <script type="text/javascript" async src="https://tenor.com/embed.js"></script>
                    <button class="popup-btn" id="authorize-btn">Continue to App</button>
                </div>
            </div>
        </div>

        <!-- Settings Panel -->
        <div class="settings-panel" id="settings-panel">
            <div class="panel-header">
                <h2 class="panel-title">Settings</h2>
                <button class="close-panel" id="close-settings">&times;</button>
            </div>
            
            <div class="settings-group">
                <h3 class="group-title">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 11.5V17.5C21 18.0304 20.7893 18.5391 20.4142 18.9142C20.0391 19.2893 19.5304 19.5 19 19.5H5C4.46957 19.5 3.96086 19.2893 3.58579 18.9142C3.21071 18.5391 3 18.0304 3 17.5V11.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7 10L12 15L17 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Thumbnail Size
                </h3>
                <div class="slider-container">
                    <input type="range" min="1" max="3" value="2" class="thumbnail-slider" id="thumbnail-slider">
                    <div class="slider-labels">
                        <span>1 column</span>
                        <span>2 columns</span>
                        <span>3 columns</span>
                    </div>
                </div>
            </div>
            
            <div class="settings-group">
                <h3 class="group-title">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 16C14.2091 16 16 14.2091 16 12C16 9.79086 14.2091 8 12 8C9.79086 8 8 9.79086 8 12C8 14.2091 9.79086 16 12 16Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M4.27 4.27L3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 10.5L3 3.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10.5 3L3.5 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M20.9999 3.5L20.9999 10.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3.5 21L10.5 21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 20.9999L13.97 20.9999" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M20.97 13.97L20.97 20.97" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Filter AI-generated posts
                </h3>
                <div class="toggle-container">
                    <span>Only show AI-generated content</span>
                    <label class="toggle-switch">
                        <input type="checkbox" id="ai-filter">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Menu Panel -->
        <div class="menu-panel" id="menu-panel">
            <div class="panel-header">
                <h2 class="panel-title">Navigation</h2>
                <button class="close-panel" id="close-menu">&times;</button>
            </div>
            
            <div class="menu-item" data-tab="posts">
                <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 7.5V16.5C21 17.0304 20.7893 17.5391 20.4142 17.9142C20.0391 18.2893 19.5304 18.5 19 18.5H5C4.46957 18.5 3.96086 18.2893 3.58579 17.9142C3.21071 17.5391 3 17.0304 3 16.5V7.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 10.5H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="menu-text">Posts</div>
            </div>
            
            <div class="menu-item" data-tab="comments">
                <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15C21 18.3137 18.3137 21 15 21H9C5.68629 21 3 18.3137 3 15V9C3 5.68629 5.68629 3 9 3H15C18.3137 3 21 5.68629 21 9V15Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 10H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 14H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 6H14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="menu-text">Comments</div>
            </div>
            
            <div class="menu-item" data-tab="wiki">
                <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6C5.46957 2 4.96086 2.21071 4.58579 2.58579C4.21071 2.96086 4 3.46957 4 4V20C4 20.5304 4.21071 21.0391 4.58579 21.4142C4.96086 21.7893 5.46957 22 6 22H18C18.5304 22 19.0391 21.7893 19.4142 21.4142C19.7893 21.0391 20 20.5304 20 20V8L14 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M14 2V8H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 13H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 17H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M10 9H9H8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="menu-text">Wiki <span class="coming-soon">(Coming soon)</span></div>
            </div>
            
            <div class="menu-item" data-tab="artists">
                <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17 21V19C17 17.9391 16.5786 16.9217 15.8284 16.1716C15.0783 15.4214 14.0609 15 13 15H5C3.93913 15 2.92172 15.4214 2.17157 16.1716C1.42143 16.9217 1 17.9391 1 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 11C11.2091 11 13 9.20914 13 7C13 4.79086 11.2091 3 9 3C6.79086 3 5 4.79086 5 7C5 9.20914 6.79086 11 9 11Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M23 21V19C22.9993 18.113 22.7044 17.2525 22.1614 16.5565C21.6184 15.8605 20.8581 15.3691 20 15.16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M16 3.13C16.9137 3.35815 17.7418 3.8453 18.366 4.52538C18.9902 5.20546 19.3794 6.04359 19.48 6.92" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="menu-text">Artists</div>
            </div>
            
            <div class="menu-item" data-tab="tags">
                <div class="menu-icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.29 3.86L1.82 18.18C1.64794 18.4724 1.56451 18.8087 1.57802 19.1456C1.59153 19.4825 1.70135 19.8062 1.89581 20.075C2.09027 20.3439 2.36159 20.5464 2.67526 20.6551C2.98893 20.7637 3.33184 20.774 3.659 20.685L18.02 16.71C18.3115 16.628 18.5769 16.4682 18.7874 16.2475C18.9979 16.0268 19.1465 15.7529 19.2177 15.453L23.13 1.73C23.258 1.261 22.91 0.78 22.43 0.65C21.96 -0.07 21.24 0.26 21.11 0.73L17.2 14.45L10.29 3.86Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M17.2 14.45L10.29 3.86" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <div class="menu-text">Tags</div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Telegram WebApp
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();
        
        // DOM Elements
        const loadingScreen = document.getElementById('loading-screen');
        const loadingProgress = document.getElementById('loading-progress');
        const mainContent = document.getElementById('main-content');
        const contentGrid = document.getElementById('content-grid');
        const postModal = document.getElementById('post-modal');
        const modalImage = document.getElementById('modal-image');
        const modalVideo = document.getElementById('modal-video');
        const profileIcon = document.getElementById('profile-icon');
        const profileOverlay = document.getElementById('profile-overlay');
        const authorizeBtn = document.getElementById('authorize-btn');
        const settingsBtn = document.getElementById('settings-btn');
        const settingsPanel = document.getElementById('settings-panel');
        const closeSettings = document.getElementById('close-settings');
        const menuBtn = document.getElementById('menu-btn');
        const menuPanel = document.getElementById('menu-panel');
        const closeMenu = document.getElementById('close-menu');
        const thumbnailSlider = document.getElementById('thumbnail-slider');
        const aiFilter = document.getElementById('ai-filter');
        const commentInput = document.getElementById('comment-input');
        const sendCommentBtn = document.getElementById('send-comment');
        const commentList = document.getElementById('comment-list');
        const pagination = document.getElementById('pagination');
        const prevPageBtn = document.getElementById('prev-page');
        const nextPageBtn = document.getElementById('next-page');

        // App State
        let currentUser = null;
        let isAuthorized = false;
        let currentPage = 1;
        let totalPages = 10; // Simulated total pages
        let thumbnailColumns = 2;
        let filterAI = false;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', () => {
            // Simulate loading process
            simulateLoading();
        });

        // Simulate loading process with progress bar
        function simulateLoading() {
            let progress = 0;
            const interval = setInterval(() => {
                progress += Math.floor(Math.random() * 5) + 1;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(initializeApp, 300);
                }
                loadingProgress.style.width = `${progress}%`;
            }, 150);
        }

        // Initialize the app after loading
        function initializeApp() {
            // Get Telegram user data
            currentUser = tg.initDataUnsafe.user || {
                id: 123456789,
                first_name: "Telegram",
                last_name: "User",
                username: "telegram_user",
                photo_url: null
            };

            // Check authorization status
            isAuthorized = localStorage.getItem('rule34_authorized') === 'true';
            
            // Set up profile icon
            if (currentUser.photo_url) {
                profileIcon.innerHTML = '';
                const img = document.createElement('img');
                img.src = currentUser.photo_url;
                img.style.width = '100%';
                img.style.height = '100%';
                img.style.objectFit = 'cover';
                profileIcon.appendChild(img);
            } else {
                profileIcon.textContent = currentUser.first_name.charAt(0) + (currentUser.last_name ? currentUser.last_name.charAt(0) : '');
            }
            
            if (!isAuthorized) {
                profileIcon.classList.add('guest');
            }
            
            // Show profile overlay for first-time users
            if (!isAuthorized) {
                setTimeout(() => {
                    profileOverlay.classList.add('active');
                }, 500);
            }
            
            // Load content
            loadContent();
            
            // Fade out loading screen and show main content
            setTimeout(() => {
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                    mainContent.style.display = 'block';
                    setTimeout(() => {
                        mainContent.style.opacity = '1';
                    }, 50);
                }, 500);
            }, 300);
        }

        // Authorize the user
        authorizeBtn.addEventListener('click', () => {
            isAuthorized = true;
            localStorage.setItem('rule34_authorized', 'true');
            profileOverlay.classList.remove('active');
            profileIcon.classList.remove('guest');
        });

        // Set up event listeners
        function setupEventListeners() {
            // Profile icon click
            profileIcon.addEventListener('click', () => {
                if (!isAuthorized) {
                    profileOverlay.classList.add('active');
                }
            });
            
            // Settings panel
            settingsBtn.addEventListener('click', () => {
                settingsPanel.classList.add('active');
            });
            
            closeSettings.addEventListener('click', () => {
                settingsPanel.classList.remove('active');
            });
            
            // Menu panel
            menuBtn.addEventListener('click', () => {
                menuPanel.classList.add('active');
            });
            
            closeMenu.addEventListener('click', () => {
                menuPanel.classList.remove('active');
            });
            
            // Thumbnail slider
            thumbnailSlider.addEventListener('input', () => {
                thumbnailColumns = parseInt(thumbnailSlider.value);
                updateGridColumns();
            });
            
            // AI filter toggle
            aiFilter.addEventListener('change', () => {
                filterAI = aiFilter.checked;
                currentPage = 1;
                loadContent();
            });
            
            // Comment functionality
            sendCommentBtn.addEventListener('click', addComment);
            commentInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addComment();
            });
            
            // Pagination
            prevPageBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    loadContent();
                }
            });
            
            nextPageBtn.addEventListener('click', () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    loadContent();
                }
            });
            
            // Close modal when clicking outside
            postModal.addEventListener('click', (e) => {
                if (e.target === postModal) {
                    postModal.classList.remove('active');
                }
            });
        }

        // Update grid columns based on slider
        function updateGridColumns() {
            contentGrid.style.gridTemplateColumns = `repeat(${thumbnailColumns}, 1fr)`;
        }

        // Load content from Rule34 API (simulated)
        function loadContent() {
            // Clear existing content
            contentGrid.innerHTML = '';
            
            // Show loading state
            const loadingItem = document.createElement('div');
            loadingItem.className = 'grid-item';
            loadingItem.style.height = '200px';
            loadingItem.style.display = 'flex';
            loadingItem.style.justifyContent = 'center';
            loadingItem.style.alignItems = 'center';
            loadingItem.innerHTML = '<div class="loading-spinner">Loading...</div>';
            contentGrid.appendChild(loadingItem);
            
            // Simulate API call
            setTimeout(() => {
                // Remove loading item
                contentGrid.innerHTML = '';
                
                // Generate random content (simulating API response)
                const itemCount = 42; // Standard Rule34 page size
                const tags = ['solo', 'breasts', 'nipples', 'panties', 'blonde', 'cat_ears', 'school_uniform'];
                
                for (let i = 0; i < itemCount; i++) {
                    // Randomly decide if it's an image or video (GIF)
                    const isVideo = Math.random() > 0.7;
                    
                    // Create grid item
                    const item = document.createElement('div');
                    item.className = 'grid-item';
                    
                    // Create image/video element
                    let mediaElement;
                    if (isVideo) {
                        mediaElement = document.createElement('video');
                        mediaElement.src = `https://media.tenor.com/${Math.floor(Math.random() * 1000)}/tenor.gif`;
                        mediaElement.autoplay = true;
                        mediaElement.loop = true;
                        mediaElement.muted = true;
                        
                        // Add video badge
                        const badge = document.createElement('div');
                        badge.className = 'video-badge';
                        badge.textContent = 'GIF';
                        item.appendChild(badge);
                    } else {
                        mediaElement = document.createElement('img');
                        // Using picsum.photos for placeholder images
                        const width = 400 + Math.floor(Math.random() * 200);
                        const height = 300 + Math.floor(Math.random() * 200);
                        mediaElement.src = `https://picsum.photos/${width}/${height}?random=${i}`;
                    }
                    
                    item.appendChild(mediaElement);
                    
                    // Add click event to open modal
                    item.addEventListener('click', () => {
                        openPostModal(isVideo ? mediaElement.src : null, isVideo ? mediaElement.src : mediaElement.src);
                    });
                    
                    contentGrid.appendChild(item);
                }
                
                // Update pagination
                updatePagination();
                
                // Setup event listeners after content loads
                setupEventListeners();
            }, 800);
        }

        // Update pagination controls
        function updatePagination() {
            // Clear existing page buttons (except prev/next)
            const existingButtons = pagination.querySelectorAll('.page-btn:not(#prev-page):not(#next-page)');
            existingButtons.forEach(btn => btn.remove());
            
            // Calculate visible page range
            const startPage = Math.max(1, currentPage - 4);
            const endPage = Math.min(totalPages, startPage + 8);
            
            // Create page buttons
            for (let i = startPage; i <= endPage; i++) {
                const pageBtn = document.createElement('button');
                pageBtn.className = `page-btn ${i === currentPage ? 'active' : ''}`;
                pageBtn.textContent = i;
                pageBtn.addEventListener('click', () => {
                    currentPage = i;
                    loadContent();
                });
                pagination.insertBefore(pageBtn, nextPageBtn);
            }
            
            // Update prev/next button states
            prevPageBtn.disabled = currentPage === 1;
            nextPageBtn.disabled = currentPage === totalPages;
        }

        // Open post modal
        function openPostModal(videoUrl, imageUrl) {
            if (videoUrl) {
                modalVideo.src = videoUrl;
                modalVideo.style.display = 'block';
                modalImage.style.display = 'none';
            } else {
                modalImage.src = imageUrl;
                modalImage.style.display = 'block';
                modalVideo.style.display = 'none';
            }
            
            postModal.classList.add('active');
        }

        // Add comment
        function addComment() {
            if (!commentInput.value.trim() || !isAuthorized) return;
            
            const commentText = commentInput.value.trim();
            commentInput.value = '';
            
            // Create comment element
            const comment = document.createElement('div');
            comment.className = 'comment';
            
            comment.innerHTML = `
                <div class="comment-avatar">${currentUser.first_name.charAt(0)}</div>
                <div class="comment-content">
                    <div class="comment-header">
                        <span class="comment-author">${currentUser.first_name}${currentUser.last_name ? ' ' + currentUser.last_name : ''}</span>
                        <span class="comment-time">Just now</span>
                    </div>
                    <div class="comment-text">${commentText}</div>
                </div>
            `;
            
            // Add to comment list
            commentList.prepend(comment);
            
            // Scroll to top of comments
            commentList.scrollTop = 0;
        }

        // Initialize comments with some examples
        function initComments() {
            const sampleComments = [
                { author: "AnimeFan2023", text: "Great post! Love the artwork!", time: "2 hours ago" },
                { author: "Rule34Lover", text: "This is amazing quality!", time: "5 hours ago" },
                { author: "ArtCollector", text: "Who's the artist? Would love to see more!", time: "1 day ago" }
            ];
            
            sampleComments.forEach(comment => {
                const commentEl = document.createElement('div');
                commentEl.className = 'comment';
                commentEl.innerHTML = `
                    <div class="comment-avatar">${comment.author.charAt(0)}</div>
                    <div class="comment-content">
                        <div class="comment-header">
                            <span class="comment-author">${comment.author}</span>
                            <span class="comment-time">${comment.time}</span>
                        </div>
                        <div class="comment-text">${comment.text}</div>
                    </div>
                `;
                commentList.appendChild(commentEl);
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            initComments();
        });
    </script>
</body>
</html>
