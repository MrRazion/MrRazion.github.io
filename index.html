<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PandaDownload | Ultimate Downloader</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0f0c29;
            --bg-gradient: linear-gradient(30deg, #0f0c29, #302b63, #24243e);
            --accent-blue: #00d2ff;
            --accent-green: #25d366;
            --accent-purple: #9d50bb;
            --accent-pink: #ff758c;
            --accent-orange: #ff7e5f;
            --text-main: #ffffff;
            --text-dim: #a0a0a0;
            --card-bg: rgba(255, 255, 255, 0.05);
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
            --radius-round: 50px;
            --radius-sq: 16px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            outline: none;
        }

        body {
            background: var(--bg-gradient);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* --- Header --- */
        header {
            padding: 20px 40px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .brand-icon {
            font-size: 2rem;
            color: var(--text-main);
        }

        .brand-name {
            font-size: 1.5rem;
            font-weight: 800;
            background: linear-gradient(90deg, #fff, #aaa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
        }

        /* --- Main Input Area --- */
        .main-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 10vh;
            width: 100%;
            max-width: 900px;
            margin: 0 auto;
            position: relative;
        }

        .input-group {
            position: relative;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .link-input-wrapper {
            position: relative;
            width: 80%;
            display: flex;
            justify-content: center;
        }

        #linkInput {
            width: 100%;
            padding: 20px 30px;
            border-radius: var(--radius-round);
            border: var(--glass-border);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 1.1rem;
            text-align: center;
            transition: 0.3s;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        #linkInput:focus {
            background: rgba(0, 0, 0, 0.5);
            border-color: var(--accent-blue);
            box-shadow: 0 0 20px rgba(0, 210, 255, 0.3);
        }

        #linkInput::placeholder {
            color: var(--text-dim);
        }

        .action-row {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 10px;
        }

        .btn {
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn:hover {
            transform: translateY(-3px);
            filter: brightness(1.2);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn-sq {
            width: 50px;
            height: 50px;
            border-radius: var(--radius-sq);
            background: var(--card-bg);
            color: var(--text-main);
            border: var(--glass-border);
            font-size: 1.2rem;
        }

        .btn-send {
            padding: 15px 40px;
            border-radius: var(--radius-round);
            background: var(--accent-blue);
            color: #000;
            font-size: 1.1rem;
            box-shadow: 0 5px 15px rgba(0, 210, 255, 0.4);
        }

        .btn-paste {
            padding: 15px 30px;
            border-radius: var(--radius-round);
            background: var(--card-bg);
            border: var(--glass-border);
            color: var(--text-main);
        }

        /* --- Stats Row --- */
        .stats-row {
            margin-top: 40px;
            display: flex;
            gap: 30px;
            color: var(--text-dim);
            font-size: 0.9rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .stat-item {
            background: rgba(255,255,255,0.03);
            padding: 8px 16px;
            border-radius: 20px;
        }

        .stat-val {
            color: var(--accent-blue);
            font-weight: bold;
            margin-left: 5px;
        }

        /* --- Modal (Available Links) --- */
        .modal-backdrop {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.4s ease;
        }

        .modal-backdrop.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background: #1a1a1a;
            width: 90%;
            max-width: 1000px;
            border-radius: 30px;
            padding: 30px;
            border: 1px solid #333;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            max-height: 90vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.4s ease;
        }

        .modal-backdrop.active .modal-content {
            transform: scale(1);
        }

        .modal-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .modal-grid { grid-template-columns: repeat(3, 1fr); }
        }
        @media (max-width: 480px) {
            .modal-grid { grid-template-columns: repeat(2, 1fr); }
        }

        .site-card {
            background: rgba(255,255,255,0.05);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: 0.2s;
        }

        .site-card:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-5px);
        }

        .site-logo {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            object-fit: cover;
        }

        .site-domain {
            font-size: 0.8rem;
            color: var(--text-dim);
            text-align: center;
        }

        .modal-close {
            margin-top: 30px;
            width: 100%;
            padding: 15px;
            background: #333;
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-weight: bold;
        }

        .modal-close:hover {
            background: #444;
        }

        /* --- Processing / Loading --- */
        .processing-ui {
            margin-top: 50px;
            display: none;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.1);
            border-top: 4px solid var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { 100% { transform: rotate(360deg); } }

        /* --- Result Area --- */
        .result-area {
            width: 100%;
            max-width: 800px;
            margin-top: 40px;
            padding-bottom: 50px;
            display: none; /* hidden by default */
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Common Result Header */
        .result-header {
            display: flex;
            flex-direction: column;
            gap: 5px;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .result-source {
            font-size: 0.9rem;
            color: var(--accent-blue);
            text-decoration: none;
            background: rgba(0, 210, 255, 0.1);
            padding: 2px 8px;
            border-radius: 4px;
            align-self: flex-start;
            cursor: pointer;
        }

        /* Video Player UI */
        .video-wrapper {
            width: 100%;
            background: #000;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.6);
        }

        video {
            width: 100%;
            display: block;
        }

        /* File UI */
        .file-card {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px;
            border-radius: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .file-icon-box {
            width: 100px;
            height: 100px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* Color classes for file types */
        .type-apk .file-icon-box { background: var(--accent-green); color: #fff; }
        .type-zip .file-icon-box { background: var(--accent-blue); color: #fff; }
        .type-exe .file-icon-box { background: var(--accent-purple); color: #fff; }
        .type-ipa .file-icon-box { background: #000; border: 1px solid #333; color: #fff; }
        .type-linux .file-icon-box { background: var(--accent-orange); color: #fff; }
        .type-audio .file-icon-box { background: var(--accent-pink); color: #fff; }

        /* Controls Row */
        .controls-row {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            width: 100%;
        }

        .select-wrapper {
            position: relative;
        }

        .quality-select {
            appearance: none;
            background: var(--card-bg);
            border: var(--glass-border);
            color: white;
            padding: 15px 40px 15px 20px;
            border-radius: var(--radius-sq);
            font-size: 1rem;
            cursor: pointer;
        }
        
        .select-arrow {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
        }

        .btn-download {
            flex: 1;
            background: var(--text-main);
            color: #000;
            font-size: 1.1rem;
            border-radius: var(--radius-sq);
            font-weight: 800;
        }

        .btn-download:hover {
            background: #e0e0e0;
        }

        /* Audio Player Specifics */
        .audio-player-ui {
            width: 100%;
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            margin-top: 10px;
        }

        .vinyl-spin {
            animation: spin 3s linear infinite;
        }

        .audio-progress {
            flex: 1;
            height: 6px;
            background: rgba(255,255,255,0.1);
            border-radius: 3px;
            position: relative;
        }
        .audio-progress-bar {
            width: 0%;
            height: 100%;
            background: var(--accent-pink);
            border-radius: 3px;
        }

        /* Download Progress Overlay */
        .download-progress-container {
            width: 100%;
            margin-top: 20px;
            background: rgba(255,255,255,0.05);
            padding: 15px;
            border-radius: 15px;
            display: none; /* hidden initially */
        }

        .progress-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            margin-bottom: 8px;
            font-family: monospace;
        }

        .progress-track {
            width: 100%;
            height: 10px;
            background: rgba(0,0,0,0.5);
            border-radius: 5px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
            width: 0%;
            transition: width 0.2s linear;
        }

    </style>
</head>
<body>

    <header>
        <i class="fas fa-paw brand-icon"></i>
        <div class="brand-name">Pandanwload</div>
    </header>

    <div class="main-container">
        
        <div class="input-group">
            <div class="link-input-wrapper">
                <input type="text" id="linkInput" placeholder="Insert Link" autocomplete="off">
            </div>

            <div class="action-row">
                <button class="btn btn-sq" onclick="openLinksModal()" title="Available Links">
                    <i class="fas fa-th-large"></i>
                </button>

                <button class="btn btn-send" onclick="processLink()">
                    SEND <i class="fas fa-paper-plane" style="margin-left:10px"></i>
                </button>

                <button class="btn btn-paste" onclick="pasteClipboard()">
                    Insert <i class="fas fa-paste" style="margin-left:8px"></i>
                </button>

                <button class="btn btn-sq">
                    <i class="fas fa-sliders-h"></i>
                </button>
            </div>
        </div>

        <div class="stats-row">
            <div class="stat-item">Downloaded: <span class="stat-val" id="statSize">0 MB</span></div>
            <div class="stat-item">Last File: <span class="stat-val" id="statLast">None</span></div>
            <div class="stat-item">Total Files: <span class="stat-val" id="statCount">0</span></div>
        </div>

        <div class="processing-ui" id="processingUi">
            <div class="spinner"></div>
            <div style="color:var(--text-dim); letter-spacing:1px; font-size: 0.9rem;" id="processText">ANALYZING LINK...</div>
        </div>

        <div class="result-area" id="resultArea">
            </div>

    </div>

    <div class="modal-backdrop" id="linksModal">
        <div class="modal-content">
            <h2 style="text-align:center; font-weight:800; font-size:2rem; margin-bottom:20px;">Supported Sites</h2>
            <div class="modal-grid" id="sitesGrid">
                </div>
            <button class="modal-close" onclick="closeLinksModal()">Close</button>
        </div>
    </div>

<script>
    // --- Global State ---
    const state = {
        totalBytes: 0,
        fileCount: 0,
        lastFile: 'None'
    };

    // --- Supported Sites Data ---
    const sites = [
        { name: 'YouTube', domain: 'youtube.com' },
        { name: 'Telegram', domain: 'telegram.org' },
        { name: 'VK Video', domain: 'vk.com' },
        { name: 'Appda', domain: 'appda.com' },
        { name: 'Pornhub', domain: 'pornhub.com' },
        { name: 'TikTok', domain: 'tiktok.com' },
        { name: 'Instagram', domain: 'instagram.com' },
        { name: 'SoundCloud', domain: 'soundcloud.com' },
        { name: 'Android', domain: 'android.com' },
        { name: 'Rule34', domain: 'rule34.xxx' }, // As requested
        { name: 'Twitter', domain: 'twitter.com' },
        { name: 'Facebook', domain: 'facebook.com' },
        { name: 'Vimeo', domain: 'vimeo.com' },
        { name: 'Twitch', domain: 'twitch.tv' },
        { name: 'Pinterest', domain: 'pinterest.com' },
        // Add more to fill rows
        { name: 'Spotify', domain: 'spotify.com' },
        { name: 'Dailymotion', domain: 'dailymotion.com' },
        { name: 'MediaFire', domain: 'mediafire.com' },
        { name: 'Google Drive', domain: 'drive.google.com' },
        { name: 'Mega', domain: 'mega.nz' }
    ];

    // --- Initialization ---
    window.onload = () => {
        renderSites();
        updateStats();
    };

    // --- Modal Logic ---
    function renderSites() {
        const grid = document.getElementById('sitesGrid');
        grid.innerHTML = '';
        sites.forEach(site => {
            const card = document.createElement('div');
            card.className = 'site-card';
            // Using Google's favicon service for ease
            const iconUrl = `https://www.google.com/s2/favicons?domain=${site.domain}&sz=64`;
            
            card.innerHTML = `
                <img src="${iconUrl}" class="site-logo" alt="${site.name}" onerror="this.src='https://via.placeholder.com/48'">
                <div class="site-domain">${site.domain}</div>
            `;
            // Add click functionality to paste domain
            card.onclick = () => {
                document.getElementById('linkInput').value = `https://${site.domain}`;
                closeLinksModal();
            };
            grid.appendChild(card);
        });
    }

    function openLinksModal() {
        document.getElementById('linksModal').classList.add('active');
    }

    function closeLinksModal() {
        document.getElementById('linksModal').classList.remove('active');
    }

    // --- Input Logic ---
    async function pasteClipboard() {
        try {
            const text = await navigator.clipboard.readText();
            document.getElementById('linkInput').value = text;
        } catch (err) {
            alert('Clipboard permission denied or not supported. Please paste manually.');
        }
    }

    // --- Core Processing Logic ---
    function processLink() {
        const url = document.getElementById('linkInput').value.trim();
        if (!url) return;

        // UI Reset
        const resultArea = document.getElementById('resultArea');
        const processingUi = document.getElementById('processingUi');
        resultArea.style.display = 'none';
        resultArea.innerHTML = '';
        processingUi.style.display = 'flex';

        // Simulate "Hard Processing" delays
        const steps = ["CONNECTING TO SERVER...", "BYPASSING SECURITY...", "EXTRACTING MEDIA...", "FINALIZING..."];
        let step = 0;
        
        const interval = setInterval(() => {
            if (step < steps.length) {
                document.getElementById('processText').innerText = steps[step];
                step++;
            } else {
                clearInterval(interval);
                processingUi.style.display = 'none';
                identifyAndRender(url);
            }
        }, 800); // 800ms per step
    }

    function identifyAndRender(url) {
        const resultArea = document.getElementById('resultArea');
        resultArea.style.display = 'block';

        let html = '';
        const lowerUrl = url.toLowerCase();

        // 1. VIDEO DETECTION
        if (lowerUrl.includes('youtu') || lowerUrl.includes('.mp4') || lowerUrl.includes('pornhub') || lowerUrl.includes('vk.com/video')) {
            html = renderVideoUI(url);
        }
        // 2. AUDIO DETECTION
        else if (lowerUrl.endsWith('.mp3') || lowerUrl.endsWith('.ogg') || lowerUrl.endsWith('.wav')) {
            html = renderAudioUI(url);
        }
        // 3. IMAGE DETECTION
        else if (lowerUrl.match(/\.(jpeg|jpg|png|gif|webp)$/)) {
            html = renderImageUI(url);
        }
        // 4. FILE DETECTION (Default fallback)
        else {
            html = renderFileUI(url);
        }

        resultArea.innerHTML = html;
        
        // Initialize custom players if needed (mock)
        if(document.getElementById('customVideo')) {
            // Setup generic video events if strictly needed
        }
    }

    // --- UI Renderers ---

    function renderVideoUI(url) {
        // Extract basic info
        let title = "Detected Video Stream";
        let isYoutube = url.includes('youtu');
        if(isYoutube) title = "YouTube Video Content";
        
        // Quality Logic: If source is 1080p, limit max.
        // We simulate a 1080p source.
        const qualities = ['1080p', '720p', '480p', '360p', '1440p', '2160p (4K)'];
        
        let optionsHtml = qualities.map(q => `<option value="${q}">${q}</option>`).join('');

        return `
            <div class="result-header">
                <div class="result-title">${title}</div>
                <a href="${url}" target="_blank" class="result-source"><i class="fas fa-link"></i> Source</a>
            </div>
            
            <div class="video-wrapper">
                <video id="customVideo" controls poster="https://via.placeholder.com/800x450/000000/FFFFFF/?text=Video+Preview">
                    <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>

            <div class="controls-row">
                <div class="select-wrapper">
                    <select id="resSelect" class="quality-select">
                        ${optionsHtml}
                    </select>
                    <i class="fas fa-chevron-down select-arrow"></i>
                </div>
                <button class="btn btn-download" onclick="startDownload('video')">
                    DOWNLOAD <i class="fas fa-download" style="margin-left:8px"></i>
                </button>
            </div>
            ${getProgressBarHTML()}
        `;
    }

    function renderFileUI(url) {
        let type = 'unknown';
        let iconClass = 'fa-file';
        let uiClass = '';
        let ext = 'FILE';

        if(url.includes('.apk')) { type = 'Android Package'; iconClass = 'fa-android'; uiClass = 'type-apk'; ext = 'APK'; }
        else if(url.includes('.zip') || url.includes('.rar')) { type = 'Archive'; iconClass = 'fa-file-zipper'; uiClass = 'type-zip'; ext = 'ZIP'; }
        else if(url.includes('.exe')) { type = 'Windows Executable'; iconClass = 'fa-compact-disc'; uiClass = 'type-exe'; ext = 'EXE'; }
        else if(url.includes('.ipa')) { type = 'iOS Package'; iconClass = 'fa-apple'; uiClass = 'type-ipa'; ext = 'IPA'; }
        else if(url.includes('.deb') || url.includes('linux')) { type = 'Linux Package'; iconClass = 'fa-linux'; uiClass = 'type-linux'; ext = 'DEB'; }

        // Extract filename
        let filename = url.split('/').pop().split('?')[0];
        if(filename.length > 30) filename = filename.substring(0, 20) + '...' + ext.toLowerCase();

        return `
            <div class="result-header">
                <div class="result-title">${filename}</div>
                <a href="${url}" target="_blank" class="result-source"><i class="fas fa-link"></i> Source</a>
            </div>

            <div class="file-card ${uiClass}" style="background: rgba(255,255,255,0.08);">
                <div class="file-icon-box">
                    <i class="fab ${iconClass}"></i>
                </div>
                <div style="font-weight:bold; font-size:1.2rem; margin-top:10px;">${ext}</div>
                <div style="color:var(--text-dim); margin-top:5px;">${type}</div>
            </div>

            <div class="controls-row">
                <button class="btn btn-download" onclick="startDownload('file', '${filename}')">
                    DOWNLOAD DIRECT <i class="fas fa-download" style="margin-left:8px"></i>
                </button>
            </div>
            ${getProgressBarHTML()}
        `;
    }

    function renderImageUI(url) {
        let filename = url.split('/').pop().split('?')[0];
        
        return `
            <div class="result-header">
                <div class="result-title">${filename}</div>
            </div>

            <div style="text-align:center; background:rgba(0,0,0,0.5); padding:20px; border-radius:20px;">
                <img src="${url}" style="max-width:100%; max-height:400px; border-radius:10px;" alt="preview">
            </div>

            <div class="controls-row">
                <div class="select-wrapper">
                    <select class="quality-select">
                        <option>Original</option>
                        <option>Upscale 2x</option>
                        <option>Upscale 4K</option>
                    </select>
                    <i class="fas fa-chevron-down select-arrow"></i>
                </div>
                <button class="btn btn-download" onclick="startDownload('image', '${filename}')">
                    DOWNLOAD <i class="fas fa-download" style="margin-left:8px"></i>
                </button>
            </div>
            ${getProgressBarHTML()}
        `;
    }

    function renderAudioUI(url) {
        let filename = url.split('/').pop().split('?')[0];

        return `
            <div class="result-header">
                <div class="result-title">${filename}</div>
            </div>

            <div class="file-card type-audio" style="background: rgba(255,255,255,0.08);">
                 <div class="file-icon-box" style="border-radius:50%; animation: spin 4s linear infinite;">
                    <i class="fas fa-compact-disc"></i>
                </div>
                <div>MP3 Audio</div>
            </div>

            <div class="audio-player-ui">
                <i class="fas fa-play" style="cursor:pointer" onclick="this.classList.toggle('fa-play'); this.classList.toggle('fa-pause')"></i>
                <div style="font-size:0.8rem">0:00</div>
                <div class="audio-progress"><div class="audio-progress-bar" style="width:30%"></div></div>
                <div style="font-size:0.8rem">3:30</div>
            </div>

            <div class="controls-row">
                 <div class="select-wrapper">
                    <select class="quality-select">
                        <option>320 kbps</option>
                        <option>256 kbps</option>
                        <option>128 kbps</option>
                    </select>
                    <i class="fas fa-chevron-down select-arrow"></i>
                </div>
                <button class="btn btn-download" onclick="startDownload('audio', '${filename}')">
                    DOWNLOAD <i class="fas fa-download" style="margin-left:8px"></i>
                </button>
            </div>
            ${getProgressBarHTML()}
        `;
    }

    function getProgressBarHTML() {
        return `
            <div class="download-progress-container" id="dlContainer">
                <div class="progress-meta">
                    <span id="dlText">0 MB / 0 MB</span>
                    <span id="dlSpeed">0 Mbit/s</span>
                </div>
                <div class="progress-track">
                    <div class="progress-fill" id="dlBar"></div>
                </div>
            </div>
        `;
    }

    // --- Simulation Logic ---

    function startDownload(type, name) {
        const dlContainer = document.getElementById('dlContainer');
        const dlBar = document.getElementById('dlBar');
        const dlText = document.getElementById('dlText');
        const dlSpeed = document.getElementById('dlSpeed');
        
        dlContainer.style.display = 'block';
        
        // Simulation variables
        let totalSizeMB = (Math.random() * 100 + 10).toFixed(1); // Random size 10-110MB
        if (type === 'video') {
            // Check quality selection simulation
            const quality = document.getElementById('resSelect') ? document.getElementById('resSelect').value : '1080p';
            // Logic: if source 1080p and req 4k -> warn or just download 1080p. Here we just set size.
            if(quality.includes('4K')) totalSizeMB = 450.5; 
            else totalSizeMB = 120.2;
            name = `video_${quality}.mp4`;
        }

        let downloaded = 0;
        let progress = 0;
        let speed = 0;

        const interval = setInterval(() => {
            // Simulate variable speed
            speed = (Math.random() * 30 + 15).toFixed(1); // 15-45 Mbit/s
            
            // Add increment
            let increment = (speed / 8) * 0.2; // roughly MB per tick (tick is 200ms)
            downloaded += increment;

            if(downloaded >= totalSizeMB) {
                downloaded = totalSizeMB;
                progress = 100;
                clearInterval(interval);
                finishDownload(name, totalSizeMB);
            } else {
                progress = (downloaded / totalSizeMB) * 100;
            }

            // Update UI
            dlBar.style.width = progress + '%';
            dlText.innerText = `${downloaded.toFixed(1)} MB / ${totalSizeMB} MB`;
            dlSpeed.innerText = `${speed} Mbit/s`;

        }, 200);
    }

    function finishDownload(name, sizeMB) {
        // Update Global Stats
        state.fileCount++;
        state.lastFile = name || 'file.ext';
        state.totalBytes += parseFloat(sizeMB);
        
        updateStats();

        // Trigger fake browser download
        const blob = new Blob(["PandaDownload Fake Content"], {type: "text/plain"});
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement("a");
        a.href = url;
        a.download = name || "download";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        alert(`Download Complete: ${name}`);
        document.getElementById('dlSpeed').innerText = "Done";
    }

    function updateStats() {
        // Format size
        let sizeStr = '';
        if(state.totalBytes > 1024) {
            sizeStr = (state.totalBytes / 1024).toFixed(2) + ' GB';
        } else {
            sizeStr = state.totalBytes.toFixed(1) + ' MB';
        }

        document.getElementById('statSize').innerText = sizeStr;
        document.getElementById('statLast').innerText = state.lastFile.length > 15 ? state.lastFile.substring(0,12)+'...' : state.lastFile;
        document.getElementById('statCount').innerText = state.fileCount;
    }

</script>
</body>
</html>
